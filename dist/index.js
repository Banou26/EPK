parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"UL96":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileType=exports.MESSAGE_TYPE=exports.targetToBundlerTarget=exports.BUNDLER_TARGET=exports.BROWSER_TARGET=exports.TARGET=exports.NODE_GLOBAL=void 0;const E="__EPK_NODE_GLOBAL";let T,_,N;exports.NODE_GLOBAL=E,exports.TARGET=T,function(E){E.NODE="node",E.ELECTRON="electron",E.DENO="deno",E.CHROME="chrome",E.CHROME_EXTENSION="chromeExtension",E.CHROME_CANARY="chromeCanary",E.CHROME_CANARY_EXTENSION="chromeCanaryExtension",E.FIREFOX="firefox",E.FIREFOX_EXTENSION="firefoxExtension",E.FIREFOX_NIGHTLY="firefoxNightly",E.FIREFOX_NIGHTLY_EXTENSION="firefoxNightlyExtension"}(T||(exports.TARGET=T={})),exports.BROWSER_TARGET=_,function(E){E[E.CHROME=T.CHROME_EXTENSION]="CHROME",E[E.CHROME_EXTENSION=T.CHROME_CANARY]="CHROME_EXTENSION",E[E.CHROME_CANARY=T.CHROME_CANARY_EXTENSION]="CHROME_CANARY",E[E.CHROME_CANARY_EXTENSION=T.FIREFOX]="CHROME_CANARY_EXTENSION",E[E.FIREFOX=T.FIREFOX_EXTENSION]="FIREFOX",E[E.FIREFOX_EXTENSION=T.FIREFOX_NIGHTLY]="FIREFOX_EXTENSION",E[E.FIREFOX_NIGHTLY=T.FIREFOX_NIGHTLY_EXTENSION]="FIREFOX_NIGHTLY",E[E.FIREFOX_NIGHTLY_EXTENSION=T.FIREFOX_NIGHTLY_EXTENSION]="FIREFOX_NIGHTLY_EXTENSION"}(_||(exports.BROWSER_TARGET=_={})),exports.BUNDLER_TARGET=N,function(E){E.NODE="node",E.BROWSER="browser",E.ELECTRON="electron"}(N||(exports.BUNDLER_TARGET=N={}));const O=E=>E in _?N.BROWSER:E===N.NODE?N.NODE:E===N.ELECTRON&&N.NODE;let R,S;exports.targetToBundlerTarget=O,exports.MESSAGE_TYPE=R,function(E){E.GET_TESTS="__EPK_GET_TESTS",E.RUN_TESTS="__EPK_RUN_TESTS",E.RUN_TEST="__EPK_RUN_TEST",E.GET_TESTS_RESPONSE="__EPK_GET_TESTS_RESPONSE",E.RUN_TESTS_RESPONSE="__EPK_RUN_TESTS_RESPONSE",E.RUN_TEST_RESPONSE="__EPK_RUN_TEST_RESPONSE"}(R||(exports.MESSAGE_TYPE=R={})),exports.FileType=S,function(E){E.ANALYZE="ANALYZE",E.TEST="TEST",E.POST_ANALYZE="POST_ANALYZE",E.DONE="DONE"}(S||(exports.FileType=S={}));
},{}],"Wis+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("path")),r=s(require("parcel-bundler")),t=require("rxjs"),n=require("rxjs/operators");function s(e){return e&&e.__esModule?e:{default:e}}var d=s=>{var d;return(d=t.Observable.create(t=>{const n=new r.default(s.entryFiles,s);return n.addAssetType("js",e.default.resolve(__dirname,"../src/core/js-asset.ts")),n.addAssetType("ts",e.default.resolve(__dirname,"../src/core/ts-asset.ts")),n.on("bundled",e=>t.next({options:s,name:"bundled",bundle:e,buildEndTime:Date.now()})),n.on("buildStart",e=>t.next({options:s,name:"buildStart",entryFiles:e,buildStartTime:Date.now()})),n.on("buildEnd",e=>t.next({name:"buildEnd"})),n.on("buildError",e=>t.next({name:"error",error:e})),n.bundle().catch(e=>t.error(e)),e=>n.stop().catch(e=>t.error(e))}),(0,n.publish)()(d)).refCount()};exports.default=d;
},{}],"s2T4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transformPathToEpkUrl=exports.transformPathToTestUrl=exports.getEmptyPageUrl=exports.prettifyPath=void 0;var e=t(require("path"));function t(e){return e&&e.__esModule?e:{default:e}}const r=t=>e.default.relative(process.cwd(),t);exports.prettifyPath=r;const s=t=>a(e.default.resolve(__dirname,"..","dist","empty.html"),t);exports.getEmptyPageUrl=s;const o=(t,r)=>`${r?`http://localhost:${r}`:""}${t.replace(`${e.default.resolve(process.cwd(),".epk","dist")}\\`,"/tests/").replace("\\","/")}`;exports.transformPathToTestUrl=o;const a=(t,r)=>`${r?`http://localhost:${r}`:""}${t.replace(`${e.default.resolve(__dirname,"..","dist")}\\`,"/epk/").replace("\\","/")}`;exports.transformPathToEpkUrl=a;
},{}],"QAaq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("Chalk")),r=n(require("readline")),t=require("grapheme-breaker"),o=n(require("strip-ansi")),s=n(require("ora")),l=n(require("path")),a=n(require("fs"));function n(e){return e&&e.__esModule?e:{default:e}}const c=(e,{color:r}={color:void 0})=>{let t,o="string"==typeof e?e:e.message;if(o||(o="Unknown error"),e.fileName){let r=e.fileName;e.loc&&(r+=`:${e.loc.line}:${e.loc.column}`),o=`${r}: ${o}`}return e.codeFrame?t=r&&e.highlightedCodeFrame||e.codeFrame:e.stack&&(t=e.stack.slice(e.stack.indexOf("\n")+1)),{message:o,stack:t}},u="win32"!==process.platform||"xterm-256color"===process.env.TERM,i={progress:u?"â³":"âˆž",success:u?"âœ¨":"âˆš",error:u?"ðŸš¨":"Ã—",warning:u?"âš ï¸":"â€¼"},d=e=>(0,o.default)(e).split("\n").reduce((e,r)=>process.stdout.columns?e+Math.ceil((r.length||1)/process.stdout.columns):e+1,0),f=(e,r,t="left")=>{const o=" ".repeat(r-p(e));return"right"===t?`${o}${e}`:`${e}${o}`},p=e=>{var r,s;return s=`${e}`,r=(0,o.default)(s),(0,t.countBreaks)(r)},g=({logLevel:t=3,color:n=e.default.supportsColor,emojis:u=i,chalk:g=new e.default.constructor({enabled:n}),isTest:m="test"===process.env.NODE_ENV}={})=>{let $,w,h=0;const v=(e,r=!1)=>{if(t>3)return b(e);r||(h+=d(e)),M(),_(e)},b=e=>{if(t<4)return;let r=new Date;e=`[${r.toLocaleTimeString()}]: ${e}`,t>4&&(w||(w=a.default.createWriteStream(l.default.join(process.cwd(),`parcel-debug-${r.toISOString()}.log`))),w.write((0,o.default)(e)+"\n")),_(e)},k=e=>t>=3&&v(e),x=(e,r)=>c(e,r),q=(e,r,t)=>{const{message:o,stack:s}=x(e,{color:n});v(t(`${r}  ${o}`)),s&&v(s)},M=()=>{$&&($.stop(),$=null)},_=e=>console.log(e),E={writeRaw:e=>{M(),h+=d(e)-1,process.stdout.write(e)},write:v,verbose:b,log:k,persistent:e=>t>=3&&v(g.bold(e),!0),warn:e=>t>=2&&q(e,u.warning,g.yellow),error:e=>t>=1&&q(e,u.error,g.red.bold),success:e=>k(`${u.success}  ${g.green.bold(e)}`),formatError:x,_writeError:q,clear:()=>{if(!(!n||m||t>3)){for(;h>0;)r.default.clearLine(process.stdout,0),r.default.moveCursor(process.stdout,0,-1),h--;r.default.cursorTo(process.stdout,0),M()}},progress:e=>{if(t<3)return;if(t>3)return b(e);const r=g.gray.bold(e);$?$.text=r:$=(0,s.default)({text:r,stream:process.stdout,enabled:!m&&void 0}).start()},stopSpinner:M,_log:_,table:(e,r)=>{let t=[];for(let o of r){let e=0;for(let r of o)t[e]=Math.max(t[e]||0,p(r)),e++}for(let o of r)k(o.map((r,o)=>{let s=e[o+1]&&e[o+1].align!==e[o].align?0:4;return f(r,t[o]+s,e[o].align)}).join(""))},handleMessage:void 0};return E.handleMessage=(({method:e,args:r})=>E[e](...r)),E};var m=g();exports.default=m;
},{}],"GeyO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=h;var e=o(require("parcel-bundler/src/utils/config")),a=o(require("command-exists")),r=o(require("../cli/logger")),t=o(require("parcel-bundler/src/utils/pipeSpawn")),l=o(require("parcel-bundler/src/utils/PromiseQueue")),n=o(require("path")),i=o(require("@parcel/fs")),s=o(require("@parcel/workers")),u=o(require("@parcel/utils")),c=o(require("resolve"));function o(e){return e&&e.__esModule?e:{default:e}}const{promisify:d}=u.default,f=d(c.default),p="yarn.lock";async function w(a,l,s={installPeers:!0,saveDev:!0,packageManager:void 0}){let{installPeers:u=!0,saveDev:c=!0,packageManager:o}=s;"string"==typeof a&&(a=[a]),r.default.progress(`Installing ${a.join(", ")}...`);let d=await e.default.resolve(l,["package.json"]),f=d?n.default.dirname(d):process.cwd();o||(o=await m(l));let p=["npm"===o?"install":"add",...a];c?p.push("-D"):"npm"===o&&p.push("--save"),"npm"!==o||d||await i.default.writeFile(n.default.join(f,"package.json"),"{}");try{await(0,t.default)(o,p,{cwd:f})}catch(w){throw new Error(`Failed to install ${a.join(", ")}.`)}u&&await Promise.all(a.map(e=>g(l,e,s)))}async function g(a,r,t){let l=n.default.dirname(a);const[i]=await f(r,{basedir:l}),s=(await e.default.load(i,["package.json"])).peerDependencies||{},u=[];for(const e in s)u.push(`${e}@${s[e]}`);u.length&&await w(u,a,Object.assign({},t,{installPeers:!1}))}async function m(a){return await e.default.resolve(a,[p])&&await v()?"yarn":"npm"}let y=null;async function v(){if(null!=y)return y;try{y=await(0,a.default)("yarn")}catch(e){y=!1}return y}let q=new l.default(w,{maxConcurrent:1,retry:!1});async function h(...e){if(!s.default.isWorker())return q.add(...e),q.run();await s.default.callMaster({location:__filename,args:e})}
},{"../cli/logger":"QAaq"}],"lL1L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=t(require("path"));function t(e){return e&&e.__esModule?e:{default:e}}function r(t){let r=e.default.normalize(t).split(e.default.sep);return"@"===r[0].charAt(0)&&r.splice(0,2,`${r[0]}/${r[1]}`),r}
},{}],"5j1f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.resolve=exports.localRequire=void 0;var e=s(require("path")),r=i(require("@parcel/utils")),t=i(require("resolve")),a=i(require("./installPackage")),o=i(require("./getModuleParts"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};a.get||a.set?Object.defineProperty(r,t,a):r[t]=e[t]}return r.default=e,r}const{promisify:l}=r.default,u=l(t.default),n=new Map,c=async(e,r,t=!1)=>{const[a]=await d(e,r,t);return require(a)};exports.localRequire=c;const d=async(r,t,i=!1)=>{let s=(0,e.dirname)(t),l=s+":"+r,c=n.get(l);if(!c){try{c=await u(r,{basedir:s})}catch(p){if("MODULE_NOT_FOUND"===p.code&&!i){const e=(0,o.default)(r)[0];return await(0,a.default)(e,t),d(r,t,!0)}throw p}n.set(l,c)}return c};exports.resolve=d;var p=async(r,t=(__dirname.includes("node_modules")?e.default.resolve(__dirname,"..",".."):__dirname))=>"string"==typeof r?c(r,t):Promise.all(r.map(e=>c(e,t)));exports.default=p;
},{"./installPackage":"GeyO","./getModuleParts":"lL1L"}],"OClX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("path")),t=require("rxjs"),r=u(require("../utils/localRequire")),l=require("../utils");function u(e){return e&&e.__esModule?e:{default:e}}let a;var o=u=>t.Observable.create(o=>{let n;a||(a=(0,r.default)("puppeteer"));const s=a.then(e=>e.launch({devtools:!0}));return s.then(r=>{n||o.next(t.Observable.create(t=>{const a=r.newPage(),o=e.default.resolve(__dirname,"..","dist","empty.html"),n=(0,l.transformPathToEpkUrl)(o,u.port);return a.then(e=>{t.next({loadFile:t=>e.goto(n).then(()=>e.addScriptTag({url:t.url})),exec:t=>e.evaluate(t)})}),()=>a.then(e=>e.close())}))}),()=>{n=!0,s.then(e=>e.close())}});exports.default=o;
},{"../utils/localRequire":"5j1f","../utils":"s2T4"}],"rfHs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("../types"),t=o(require("../targets/chrome")),r=require("rxjs/operators");function o(e){return e&&e.__esModule?e:{default:e}}const s=new Map([[e.TARGET.CHROME,t.default]]);var a=(e,t)=>{var o;const a=s.get(e)(t);return a.target=e,a.options=t,o=a,(0,r.map)(r=>(r.target=e,r.options=t,r))(o)};exports.default=a;
},{"../types":"UL96","../targets/chrome":"OClX"}],"hIne":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isBrowser=exports.prettifyTime=exports.stringify=void 0;const e=(e,...t)=>e.reduce((e,s,r)=>`${e}${s}${t.length>r?JSON.stringify(t[r]):""}`,"");exports.stringify=e;const t=e=>e<1e3?`${e.toFixed()}ms`:`${(e/1e3).toFixed(2)}s`;exports.prettifyTime=t;const s="undefined"!=typeof window;exports.isBrowser=s;
},{}],"x4LZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("rxjs/operators"),t=require("../types"),r=require("./utils");const a=e=>r.stringify`
new Promise(resolve => {
  window.addEventListener('message', ({ data }) =>
    data.type === ${t.MESSAGE_TYPE.GET_TESTS_RESPONSE}
    && resolve(data))
  window.postMessage(${e}, '*')
})
`,s=e=>r.stringify`
new Promise(resolve => {
  global[${t.NODE_GLOBAL}].addListener('message', ({ data }) =>
    data.type === ${t.MESSAGE_TYPE.GET_TESTS_RESPONSE}
    && resolve(data))
  global[${t.NODE_GLOBAL}].emit('message', ${e})
})
`,E=(e,r)=>e.target===t.BUNDLER_TARGET.BROWSER?a(r):s(r);var o=(r,a)=>(0,e.switchMap)(s=>{var o,i;return i=r,o=(0,e.mergeMap)(async e=>{await e.loadFile(s);const{data:r,errors:o}=await e.exec(E(a,{type:t.MESSAGE_TYPE.GET_TESTS}));return{type:t.FileType.ANALYZE,...s,tests:r,errors:o}})(i),(0,e.take)(1)(o)});exports.default=o;
},{"../types":"UL96","./utils":"hIne"}],"kg0f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("rxjs/operators"),t=require("../types"),a=require("./utils");const r=e=>a.stringify`
new Promise(resolve => {
  window.addEventListener('message', ({ data }) =>
    data.type === ${t.MESSAGE_TYPE.RUN_TEST_RESPONSE}
    && resolve(data))
  window.postMessage(${e}, '*')
})
`,s=e=>a.stringify`
new Promise(resolve => {
  global[${t.NODE_GLOBAL}].addListener('message', ({ data }) =>
    data.type === ${t.MESSAGE_TYPE.RUN_TEST_RESPONSE}
    && resolve(data))
  global[${t.NODE_GLOBAL}].emit('message', ${e})
})
`,i=(e,a)=>e.target===t.BUNDLER_TARGET.BROWSER?r(a):s(a);var o=(a,r,s)=>(0,e.mergeMap)(o=>{var E,d;return d=r,E=(0,e.mergeMap)(async e=>{await e.loadFile(a);const{data:r}=await e.exec(i(s,{type:t.MESSAGE_TYPE.RUN_TEST,description:o.description}));return{...a,type:t.FileType.TEST,test:{...o,...r}}})(d),(0,e.take)(1)(E)});exports.default=o;
},{"../types":"UL96","./utils":"hIne"}],"hsK/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("stacktrace-parser")),r=l(require("source-map")),a=require("rxjs/operators"),t=require("../types"),n=l(require("path")),i=l(require("fs")),s=require("util"),o=require("../utils/index");function l(e){return e&&e.__esModule?e:{default:e}}const u=(0,s.promisify)(i.default.readFile),c=({originalColumn:e,originalLine:r,source:a})=>`${a}:${r}:${e}`,m=e=>`at ${e.originalName?`${e.originalName} (${c(e)})`:c(e)}`,p=e=>`${e.name}: ${e.message}\n\n${e.metaStack.map(m).join("\n")}\n`;var f=i=>{const s=new Map,l=new Map;return(0,a.mergeMap)(async a=>{const{name:c}=i;if(!s.has(c)){const e=await u(c,{encoding:"utf8"});s.set(c,e)}for(const e of i.childBundles){const{name:r}=e;if(!s.has(r)){const e=await u(r,{encoding:"utf8"});s.set(r,e)}}const m=`${c.slice(0,-3)}.map`,f=JSON.parse(s.get(m)),d=l.get(a.url)||new r.default.SourceMapConsumer(f);l.has(a.url)||l.set(a.url,d);const{test:{errors:g}}=a,$=await Promise.all(g.map(async r=>{const a=await Promise.all(e.default.parse("AssertionError"===r.name?r.stack.replace(r.string,""):r.stack).map(async({lineNumber:e,column:r,file:a,methodName:t})=>{const{line:i,column:s,name:l,source:u}=await d.originalPositionFor({line:e,column:null===r?0:r});return{file:a,name:t,line:e,column:r,originalLine:i,originalColumn:s,originalName:l,source:(0,o.prettifyPath)(n.default.resolve(n.default.dirname(c),u.replace("tests\\unit/..","")))}})),t={...r,metaStack:a};return t.originalStack=p(t),t}));return{...a,type:t.FileType.POST_ANALYZE,test:{...a.test,errors:$}}})};exports.default=f;
},{"../types":"UL96","../utils/index":"s2T4"}],"ZgGC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("path")),t=require("rxjs"),r=require("rxjs/operators"),s=u(require("../utils/localRequire"));function u(e){return e&&e.__esModule?e:{default:e}}let o;var a=u=>(0,r.switchMap)(r=>t.Observable.create(t=>{const{port:a}=u;o||(o=(0,s.default)(["koa","koa-static","koa-mount"]));const l=o.then(([s,u,o])=>{const l=new s,n=new s;n.use(u(e.default.resolve(__dirname,"..","dist")));const i=new s;i.use(u(e.default.resolve(process.cwd(),".epk","dist"))),l.use(o("/epk",n)),l.use(o("/tests",i));try{return l.listen(a)}finally{t.next(r)}});return e=>l.then(e=>e.close())}));exports.default=a;
},{"../utils/localRequire":"5j1f"}],"7QpE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("rxjs"),r=require("rxjs/operators"),t=require("../types"),a=c(require("./bundler")),s=require("../utils/index"),u=c(require("./target-runtime-provider")),o=c(require("./analyze")),i=c(require("./test")),l=c(require("./post-analyze")),n=require("./utils"),d=c(require("./server")),p=c(require("../utils/localRequire"));function c(e){return e&&e.__esModule?e:{default:e}}var R=c=>{var R,f,m;Object.keys(c).forEach(e=>void 0===c[e]&&delete c[e]);const h=c.target||t.BUNDLER_TARGET.BROWSER,E={browsers:["chrome"],target:h,outDir:`.epk/dist/${h}`,watch:!0,cache:!0,cacheDir:`.epk/cache/${h}`,port:void 0,minify:!1,scopeHoist:!1,logLevel:0,sourceMaps:!0,detailedReport:!1,throwErrors:!0,hmr:!1,...c};let g;return n.isBrowser||E.target!==t.BUNDLER_TARGET.BROWSER||(g=(0,p.default)("get-port").then(e=>e({port:10485})).then(e=>E.port=e)),m=(0,e.of)([(0,a.default)(E),(n.isBrowser||E.target!==t.BUNDLER_TARGET.BROWSER?[E.target]:E.browsers).map(e=>(0,u.default)(e,E))]),f=(n.isBrowser||E.target!==t.BUNDLER_TARGET.BROWSER?(0,r.tap)():(0,r.delayWhen)(()=>(0,e.from)(g)))(m),R=(n.isBrowser||E.target!==t.BUNDLER_TARGET.BROWSER?(0,r.tap)():(0,d.default)(E))(f),(0,r.mergeMap)(([a,u])=>{var n,d,p;return(0,e.merge)((n=a,(0,r.filter)(({name:e})=>"buildStart"===e)(n)),(d=a,(0,r.filter)(({name:e})=>"bundled"===e)(d)),(p=(0,e.merge)(...u),(0,r.mergeMap)(u=>{var n,d;return d=a,n=(0,r.filter)(({name:e})=>"bundled"===e)(d),(0,r.switchMap)(({bundle:a})=>{var n;return n=(0,e.from)(a.isEmpty?Array.from(a.childBundles):[a]),(0,r.mergeMap)(a=>{var n,d,p,c,R,f,m,h;const{name:g}=a,B=(n=(0,e.of)({target:u.target,name:a.entryAsset.name,path:g,url:E.target===t.BUNDLER_TARGET.BROWSER&&(0,s.transformPathToTestUrl)(g,E.port)}),(0,r.publish)()(n)),v=(p=B,d=(0,o.default)(u,E)(p),(0,r.publish)()(d)),T=(f=v,R=(0,r.filter)(({errors:e})=>!e.length)(f),c=(0,r.switchMap)(r=>{var t;return t=(0,e.from)(r.tests),(0,i.default)(r,u,E)(t)})(R),(0,r.publish)()(c)),b=(h=T,m=(0,l.default)(a)(h),(0,r.publish)()(m)),q=(0,e.merge)(B,v,T,b);return b.connect(),T.connect(),v.connect(),B.connect(),q})(n)})(n)})(p)))})(R)};exports.default=R;
},{"../types":"UL96","./bundler":"Wis+","../utils/index":"s2T4","./target-runtime-provider":"rfHs","./analyze":"x4LZ","./test":"kg0f","./post-analyze":"hsK/","./utils":"hIne","./server":"ZgGC","../utils/localRequire":"5j1f"}],"2LYJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.errors=void 0;var e=require("../core/utils");const r=[];exports.errors=r,e.isBrowser?window.addEventListener("error",e=>r.push(e)):process.on("uncaughtException",e=>r.push(e));
},{"../core/utils":"hIne"}],"YymI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.test=exports.fail=exports.pass=exports.todo=exports.tests=void 0;var e=require("events"),r=require("flatted/cjs"),t=require("../core/utils"),s=require("../types"),o=require("./error"),i=require("rxjs");const a=new Map;exports.tests=a;const n=e=>{};exports.todo=n;const p=e=>{};exports.pass=p;const E=e=>{};exports.fail=E;const c=(e,r)=>{if("string"!=typeof e)throw new Error("desc has to be a string");if("function"!=typeof r)throw new Error("func has to be a function");if(a.has(e))throw new Error(`Found duplicate test description: ${e}`);a.set(e,r)};exports.test=c;const d=new Promise(e=>setTimeout(e,0)),S=(e,r)=>t.isBrowser?window.parent.postMessage({type:e,errors:o.errors,data:r},"*"):global[s.NODE_GLOBAL].emit("message",{type:e,errors:o.errors,data:r}),f=()=>S(s.MESSAGE_TYPE.GET_TESTS_RESPONSE,Array.from(a).map(([e,r])=>({description:e,body:r.toString()}))),m=async e=>{const{performance:t}=window;let n,p,E,c;try{n=t.now(),E=await a.get(e)()}catch(d){c=d}finally{p=t.now()}S(s.MESSAGE_TYPE.RUN_TEST_RESPONSE,{timeStart:n,timeEnd:p,type:(0,i.isObservable)(E)?"observable":E instanceof Promise?"promise":"function",value:(0,r.stringify)(E),errors:(c?[c,...o.errors]:o.errors).map(e=>({name:e.name,message:e.message,string:e.toString(),stack:e.stack}))})},l=({data:{type:e,description:r}})=>e===s.MESSAGE_TYPE.GET_TESTS?f():e===s.MESSAGE_TYPE.RUN_TEST&&m(r);if(t.isBrowser)window.addEventListener("message",l);else{(global[s.NODE_GLOBAL]=new e.EventEmitter).addListener("message",l)}
},{"../core/utils":"hIne","../types":"UL96","./error":"2LYJ"}],"kBKS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=void 0;var e=t(require("power-assert"));function t(e){return e&&e.__esModule?e:{default:e}}const r=e.default.customize({});exports.assert=r;
},{}],"Gd7L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"test",{enumerable:!0,get:function(){return e.test}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return t.assert}});var e=require("./test"),t=require("./assert");
},{"./test":"YymI","./assert":"kBKS"}],"3Fhe":[function(require,module,exports) {
var t=null;function r(){return t||(t=e()),t}function e(){try{throw new Error}catch(r){var t=(""+r.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return n(t[0])}return"/"}function n(t){return(""+t).replace(/^((?:https?|file|ftp):\/\/.+)\/[^\/]+$/,"$1")+"/"}exports.getBundleURL=r,exports.getBaseURL=n;
},{}],"21/1":[function(require,module,exports) {
var r=require("./bundle-url").getBundleURL;function e(r){Array.isArray(r)||(r=[r]);var e=r[r.length-1];try{return Promise.resolve(require(e))}catch(n){if("MODULE_NOT_FOUND"===n.code)return new s(function(n,i){t(r.slice(0,-1)).then(function(){return require(e)}).then(n,i)});throw n}}function t(r){return Promise.all(r.map(u))}var n={};function i(r,e){n[r]=e}module.exports=exports=e,exports.load=t,exports.register=i;var o={};function u(e){var t;if(Array.isArray(e)&&(t=e[1],e=e[0]),o[e])return o[e];var i=(e.substring(e.lastIndexOf(".")+1,e.length)||e).toLowerCase(),u=n[i];return u?o[e]=u(r()+e).then(function(r){return r&&module.bundle.register(t,r),r}).catch(function(r){throw delete o[e],r}):void 0}function s(r){this.executor=r,this.promise=null}s.prototype.then=function(r,e){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.then(r,e)},s.prototype.catch=function(r){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.catch(r)};
},{"./bundle-url":"3Fhe"}],"7QCb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./core/index");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./test/index");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})}),module.parent||require("_bundle_loader")(require.resolve("./cli/index")).then(()=>{});
},{"./core/index":"7QpE","./test/index":"Gd7L","_bundle_loader":"21/1","./cli/index":[["cli.f497c405.js","Q0HP"],"cli.f497c405.map","Q0HP"]}],"gIV6":[function(require,module,exports) {
var n=require("fs");module.exports=function(e){return new Promise(function(t,i){n.readFile(__dirname+e,"utf8",function(n,e){n?i(n):setImmediate(function(){t(e)})})}).then(function(n){new Function("",n)()})};
},{}],0:[function(require,module,exports) {
var b=require("21/1");b.register("js",require("gIV6"));
},{}]},{},[0,"7QCb"], null)
//# sourceMappingURL=index.map