parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"hIne":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.globalVariable=exports.isBrowser=exports.prettifyTime=exports.stringify=void 0;const e=(e,...t)=>e.reduce((e,o,s)=>`${e}${o}${t.length>s?JSON.stringify(t[s]):""}`,"");exports.stringify=e;const t=e=>e<1e3?`${e.toFixed()}ms`:`${(e/1e3).toFixed(2)}s`;exports.prettifyTime=t;const o="undefined"!=typeof window;exports.isBrowser=o;const s=o?window:global;exports.globalVariable=s;
},{}],"UL96":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LogType=exports.FileType=exports.MESSAGE_TYPE=exports.targetToBundlerTarget=exports.BUNDLER_TARGET=exports.BROWSER_TARGET=exports.TARGET=exports.FUNCTION_PROPERTY=exports.NODE_GLOBAL=void 0;const E="__EPK_NODE_GLOBAL__";exports.NODE_GLOBAL=E;const _="__EPK__FUNCTION__PLACEHOLDER__";let T,N,O;exports.FUNCTION_PROPERTY=_,exports.TARGET=T,function(E){E.NODE="node",E.ELECTRON="electron",E.DENO="deno",E.CHROME="chrome",E.CHROME_EXTENSION="chromeExtension",E.CHROME_CANARY="chromeCanary",E.CHROME_CANARY_EXTENSION="chromeCanaryExtension",E.FIREFOX="firefox",E.FIREFOX_EXTENSION="firefoxExtension",E.FIREFOX_NIGHTLY="firefoxNightly",E.FIREFOX_NIGHTLY_EXTENSION="firefoxNightlyExtension"}(T||(exports.TARGET=T={})),exports.BROWSER_TARGET=N,function(E){E[E.CHROME=T.CHROME_EXTENSION]="CHROME",E[E.CHROME_EXTENSION=T.CHROME_CANARY]="CHROME_EXTENSION",E[E.CHROME_CANARY=T.CHROME_CANARY_EXTENSION]="CHROME_CANARY",E[E.CHROME_CANARY_EXTENSION=T.FIREFOX]="CHROME_CANARY_EXTENSION",E[E.FIREFOX=T.FIREFOX_EXTENSION]="FIREFOX",E[E.FIREFOX_EXTENSION=T.FIREFOX_NIGHTLY]="FIREFOX_EXTENSION",E[E.FIREFOX_NIGHTLY=T.FIREFOX_NIGHTLY_EXTENSION]="FIREFOX_NIGHTLY",E[E.FIREFOX_NIGHTLY_EXTENSION=T.FIREFOX_NIGHTLY_EXTENSION]="FIREFOX_NIGHTLY_EXTENSION"}(N||(exports.BROWSER_TARGET=N={})),exports.BUNDLER_TARGET=O,function(E){E.NODE="node",E.BROWSER="browser",E.ELECTRON="electron"}(O||(exports.BUNDLER_TARGET=O={}));const R=E=>E in N?O.BROWSER:E===O.NODE?O.NODE:E===O.ELECTRON&&O.NODE;let e,o,S;exports.targetToBundlerTarget=R,exports.MESSAGE_TYPE=e,function(E){E.GET_TESTS="__EPK_GET_TESTS",E.RUN_TESTS="__EPK_RUN_TESTS",E.RUN_TEST="__EPK_RUN_TEST",E.GET_TESTS_RESPONSE="__EPK_GET_TESTS_RESPONSE",E.RUN_TESTS_RESPONSE="__EPK_RUN_TESTS_RESPONSE",E.RUN_TEST_RESPONSE="__EPK_RUN_TEST_RESPONSE"}(e||(exports.MESSAGE_TYPE=e={})),exports.FileType=o,function(E){E.ANALYZE="ANALYZE",E.TEST="TEST",E.POST_ANALYZE="POST_ANALYZE",E.DONE="DONE"}(o||(exports.FileType=o={})),exports.LogType=S,function(E){E.log="log",E.info="info",E.warn="warn",E.error="error",E.uncaughtError="uncaughtError"}(S||(exports.LogType=S={}));
},{}],"kg0f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("rxjs/operators"),t=require("./utils.ts"),a=require("../types.ts"),r=require("flatted");const s=e=>t.stringify`
new Promise(resolve => {
  window.addEventListener('message', ({ data }) =>
    data.type === ${a.MESSAGE_TYPE.RUN_TEST_RESPONSE}
    && resolve(data))
  window.postMessage(${e}, '*')
})
`,i=e=>t.stringify`
new Promise(resolve => {
  global[${a.NODE_GLOBAL}].addListener('message', ({ data }) =>
    data.type === ${a.MESSAGE_TYPE.RUN_TEST_RESPONSE}
    && resolve(data))
  global[${a.NODE_GLOBAL}].emit('message', ${e})
})
`,o=(e,t)=>e.target===a.BUNDLER_TARGET.BROWSER?s(t):i(t);var E=(t,s,i)=>(0,e.mergeMap)(E=>{var d,l;return l=s,d=(0,e.mergeMap)(async e=>{await e.loadFile(t);const{data:s}=await e.exec(o(i,{type:a.MESSAGE_TYPE.RUN_TEST,description:E.description}));return{...t,type:a.FileType.TEST,test:{...E,...s,logs:(0,r.parse)(s.logs,(e,t)=>(null==t?void 0:t[a.FUNCTION_PROPERTY])?{[t[a.FUNCTION_PROPERTY]]:()=>{}}[t[a.FUNCTION_PROPERTY]]:t)}}})(l),(0,e.take)(1)(d)});exports.default=E;
},{"./utils.ts":"hIne","../types.ts":"UL96"}],"QAaq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("fs")),r=n(require("path")),t=n(require("ora")),o=n(require("Chalk")),s=n(require("readline")),l=n(require("strip-ansi")),a=require("grapheme-breaker");function n(e){return e&&e.__esModule?e:{default:e}}const c=(e,{color:r}={color:void 0})=>{let t,o="string"==typeof e?e:e.message;if(o||(o="Unknown error"),e.fileName){let r=e.fileName;e.loc&&(r+=`:${e.loc.line}:${e.loc.column}`),o=`${r}: ${o}`}return e.codeFrame?t=r&&e.highlightedCodeFrame||e.codeFrame:e.stack&&(t=e.stack.slice(e.stack.indexOf("\n")+1)),{message:o,stack:t}},u="win32"!==process.platform||"xterm-256color"===process.env.TERM,i={progress:u?"⏳":"∞",success:u?"✨":"√",error:u?"🚨":"×",warning:u?"⚠️":"‼"},d=e=>(0,l.default)(e).split("\n").reduce((e,r)=>process.stdout.columns?e+Math.ceil((r.length||1)/process.stdout.columns):e+1,0),f=(e,r,t="left")=>{const o=" ".repeat(r-p(e));return"right"===t?`${o}${e}`:`${e}${o}`},p=e=>{var r,t;return t=`${e}`,r=(0,l.default)(t),(0,a.countBreaks)(r)},g=({logLevel:a=3,color:n=o.default.supportsColor,emojis:u=i,chalk:g=new o.default.constructor({enabled:n}),isTest:m="test"===process.env.NODE_ENV}={})=>{let $,w,h=0;const v=(e,r=!1)=>{if(a>3)return b(e);r||(h+=d(e)),M(),_(e)},b=t=>{if(a<4)return;let o=new Date;t=`[${o.toLocaleTimeString()}]: ${t}`,a>4&&(w||(w=e.default.createWriteStream(r.default.join(process.cwd(),`parcel-debug-${o.toISOString()}.log`))),w.write((0,l.default)(t)+"\n")),_(t)},k=e=>a>=3&&v(e),x=(e,r)=>c(e,r),q=(e,r,t)=>{const{message:o,stack:s}=x(e,{color:n});v(t(`${r}  ${o}`)),s&&v(s)},M=()=>{$&&($.stop(),$=null)},_=e=>console.log(e),E={writeRaw:e=>{M(),h+=d(e)-1,process.stdout.write(e)},write:v,verbose:b,log:k,persistent:e=>a>=3&&v(g.bold(e),!0),warn:e=>a>=2&&q(e,u.warning,g.yellow),error:e=>a>=1&&q(e,u.error,g.red.bold),success:e=>k(`${u.success}  ${g.green.bold(e)}`),formatError:x,_writeError:q,clear:()=>{if(!(!n||m||a>3)){for(;h>0;)s.default.clearLine(process.stdout,0),s.default.moveCursor(process.stdout,0,-1),h--;s.default.cursorTo(process.stdout,0),M()}},progress:e=>{if(a<3)return;if(a>3)return b(e);const r=g.gray.bold(e);$?$.text=r:$=(0,t.default)({text:r,stream:process.stdout,enabled:!m&&void 0}).start()},stopSpinner:M,_log:_,table:(e,r)=>{let t=[];for(let o of r){let e=0;for(let r of o)t[e]=Math.max(t[e]||0,p(r)),e++}for(let o of r)k(o.map((r,o)=>{let s=e[o+1]&&e[o+1].align!==e[o].align?0:4;return f(r,t[o]+s,e[o].align)}).join(""))},handleMessage:void 0};return E.handleMessage=(({method:e,args:r})=>E[e](...r)),E};var m=g();exports.default=m;
},{}],"GeyO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=h;var e=o(require("path")),a=o(require("@parcel/fs")),r=o(require("resolve")),t=o(require("@parcel/utils")),l=o(require("@parcel/workers")),n=o(require("command-exists")),i=o(require("parcel-bundler/src/utils/config")),s=o(require("parcel-bundler/src/utils/pipeSpawn")),u=o(require("parcel-bundler/src/utils/PromiseQueue")),c=o(require("../cli/logger.ts"));function o(e){return e&&e.__esModule?e:{default:e}}const{promisify:d}=t.default,f=d(r.default),p="yarn.lock";async function w(r,t,l={installPeers:!0,saveDev:!0,packageManager:void 0}){let{installPeers:n=!0,saveDev:u=!0,packageManager:o}=l;"string"==typeof r&&(r=[r]),c.default.progress(`Installing ${r.join(", ")}...`);let d=await i.default.resolve(t,["package.json"]),f=d?e.default.dirname(d):process.cwd();o||(o=await m(t));let p=["npm"===o?"install":"add",...r];u?p.push("-D"):"npm"===o&&p.push("--save"),"npm"!==o||d||await a.default.writeFile(e.default.join(f,"package.json"),"{}");try{await(0,s.default)(o,p,{cwd:f})}catch(w){throw new Error(`Failed to install ${r.join(", ")}.`)}n&&await Promise.all(r.map(e=>g(t,e,l)))}async function g(a,r,t){let l=e.default.dirname(a);const[n]=await f(r,{basedir:l}),s=(await i.default.load(n,["package.json"])).peerDependencies||{},u=[];for(const e in s)u.push(`${e}@${s[e]}`);u.length&&await w(u,a,Object.assign({},t,{installPeers:!1}))}async function m(e){return await i.default.resolve(e,[p])&&await v()?"yarn":"npm"}let y=null;async function v(){if(null!=y)return y;try{y=await(0,n.default)("yarn")}catch(e){y=!1}return y}let q=new u.default(w,{maxConcurrent:1,retry:!1});async function h(...e){if(!l.default.isWorker())return q.add(...e),q.run();await l.default.callMaster({location:__filename,args:e})}
},{"../cli/logger.ts":"QAaq"}],"lL1L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=t(require("path"));function t(e){return e&&e.__esModule?e:{default:e}}function r(t){let r=e.default.normalize(t).split(e.default.sep);return"@"===r[0].charAt(0)&&r.splice(0,2,`${r[0]}/${r[1]}`),r}
},{}],"5j1f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.resolve=exports.localRequire=void 0;var e=i(require("resolve")),r=i(require("@parcel/utils")),t=s(require("path")),a=i(require("./installPackage.ts")),o=i(require("./getModuleParts.ts"));function s(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};a.get||a.set?Object.defineProperty(r,t,a):r[t]=e[t]}return r.default=e,r}function i(e){return e&&e.__esModule?e:{default:e}}const{promisify:l}=r.default,u=l(e.default),n=new Map,c=async(e,r,t=!1)=>{const[a]=await d(e,r,t);return require(a)};exports.localRequire=c;const d=async(e,r,s=!1)=>{let i=(0,t.dirname)(r),l=i+":"+e,c=n.get(l);if(!c){try{c=await u(e,{basedir:i})}catch(p){if("MODULE_NOT_FOUND"===p.code&&!s){const t=(0,o.default)(e)[0];return await(0,a.default)(t,r),d(e,r,!0)}throw p}n.set(l,c)}return c};exports.resolve=d;var p=async(e,r=(__dirname.includes("node_modules")?t.default.resolve(__dirname,"..",".."):__dirname))=>"string"==typeof e?c(e,r):Promise.all(e.map(e=>c(e,r)));exports.default=p;
},{"./installPackage.ts":"GeyO","./getModuleParts.ts":"lL1L"}],"ZgGC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("path")),t=require("rxjs"),r=require("rxjs/operators"),s=u(require("../utils/localRequire.ts"));function u(e){return e&&e.__esModule?e:{default:e}}let o;var a=u=>(0,r.switchMap)(r=>t.Observable.create(t=>{const{port:a}=u;o||(o=(0,s.default)(["koa","koa-static","koa-mount"]));const l=o.then(([s,u,o])=>{const l=new s,n=new s;n.use(u(e.default.resolve(__dirname,"..","dist")));const i=new s;i.use(u(e.default.resolve(process.cwd(),".epk","dist"))),l.use(o("/epk",n)),l.use(o("/tests",i));try{return l.listen(a)}finally{t.next(r)}});return e=>l.then(e=>e.close())}));exports.default=a;
},{"../utils/localRequire.ts":"5j1f"}],"x4LZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("rxjs/operators"),t=require("./utils.ts"),a=require("../types.ts");const s=e=>t.stringify`
new Promise(resolve => {
  window.addEventListener('message', ({ data }) =>
    data.type === ${a.MESSAGE_TYPE.GET_TESTS_RESPONSE}
    && resolve(data))
  window.postMessage(${e}, '*')
})
`,r=e=>t.stringify`
new Promise(resolve => {
  global[${a.NODE_GLOBAL}].addListener('message', ({ data }) =>
    data.type === ${a.MESSAGE_TYPE.GET_TESTS_RESPONSE}
    && resolve(data))
  global[${a.NODE_GLOBAL}].emit('message', ${e})
})
`,E=(e,t)=>e.target===a.BUNDLER_TARGET.BROWSER?s(t):r(t);var o=(t,s)=>(0,e.switchMap)(r=>{var o,i;return i=t,o=(0,e.mergeMap)(async e=>{await e.loadFile(r);const{data:t,logs:o}=await e.exec(E(s,{type:a.MESSAGE_TYPE.GET_TESTS}));return{type:a.FileType.ANALYZE,...r,tests:t,logs:o}})(i),(0,e.take)(1)(o)});exports.default=o;
},{"./utils.ts":"hIne","../types.ts":"UL96"}],"Wis+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("path")),r=require("rxjs"),t=require("rxjs/operators"),n=s(require("parcel-bundler"));function s(e){return e&&e.__esModule?e:{default:e}}var d=s=>{var d;return(d=r.Observable.create(r=>{const t=new n.default(s.entryFiles,s);return t.addAssetType("js",e.default.resolve(__dirname,"../src/core/js-asset.ts")),t.addAssetType("ts",e.default.resolve(__dirname,"../src/core/ts-asset.ts")),t.on("bundled",e=>r.next({options:s,name:"bundled",bundle:e,buildEndTime:Date.now()})),t.on("buildStart",e=>r.next({options:s,name:"buildStart",entryFiles:e,buildStartTime:Date.now()})),t.on("buildEnd",e=>r.next({name:"buildEnd"})),t.on("buildError",e=>r.next({name:"error",error:e})),t.bundle().catch(e=>r.error(e)),e=>t.stop().catch(e=>r.error(e))}),(0,t.publish)()(d)).refCount()};exports.default=d;
},{}],"s2T4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transformPathToEpkUrl=exports.transformPathToTestUrl=exports.getEmptyPageUrl=exports.prettifyPath=void 0;var e=t(require("path"));function t(e){return e&&e.__esModule?e:{default:e}}const r=t=>e.default.relative(process.cwd(),t);exports.prettifyPath=r;const s=t=>a(e.default.resolve(__dirname,"..","dist","empty.html"),t);exports.getEmptyPageUrl=s;const o=(t,r)=>`${r?`http://localhost:${r}`:""}${t.replace(`${e.default.resolve(process.cwd(),".epk","dist")}\\`,"/tests/").replace("\\","/")}`;exports.transformPathToTestUrl=o;const a=(t,r)=>`${r?`http://localhost:${r}`:""}${t.replace(`${e.default.resolve(__dirname,"..","dist")}\\`,"/epk/").replace("\\","/")}`;exports.transformPathToEpkUrl=a;
},{}],"hsK/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("fs")),r=l(require("path")),t=require("util"),a=l(require("source-map")),o=require("rxjs/operators"),n=require("stacktrace-parser"),s=require("../utils/index.ts"),i=require("../types.ts");function l(e){return e&&e.__esModule?e:{default:e}}const u=(0,t.promisify)(e.default.readFile),c=({originalColumn:e,originalLine:r,source:t})=>`${t}:${r}:${e}`,p=e=>`at ${e.originalName?`${e.originalName} (${c(e)})`:c(e)}`,m=e=>`${e.name}: ${e.message}\n\n${e.metaStack.map(p).join("\n")}\n`;var d=(e,t)=>{const l=new Map,c=new Map;return(0,o.mergeMap)(async o=>{const{name:p}=t;if(!l.has(p)){const e=await u(p,{encoding:"utf8"});l.set(p,e)}for(const e of t.childBundles){const{name:r}=e;if(!l.has(r)){const e=await u(r,{encoding:"utf8"});l.set(r,e)}}const d=l.has(`${p.slice(0,-3)}.map`)?`${p.slice(0,-3)}.map`:`${p}.map`,f=JSON.parse(l.get(d)),g=c.get(o.url)||new a.default.SourceMapConsumer(f);c.has(o.url)||c.set(o.url,g);const{test:{logs:y}}=o,$=y.filter(({type:e})=>e===i.LogType.uncaughtError).map(({error:e})=>e),h=await Promise.all($.map(async t=>{const a=await Promise.all((0,n.parse)("AssertionError"===t.name?t.stack.replace(t.string,""):t.stack).map(async({lineNumber:t,column:a,file:o,methodName:n})=>{const{line:i,column:l,name:u,source:c}=await g.originalPositionFor({source:o,line:t,column:null===a?0:a});return{file:o,name:n,line:t,column:a,originalLine:i,originalColumn:l,originalName:u,source:(0,s.prettifyPath)(r.default.resolve(c.includes(g.sourceRoot)?r.default.resolve(process.cwd(),e.outDir):process.cwd(),c))}})),o={...t,metaStack:a};return o.originalStack=m(o),o})),w=y.map(e=>e.type===i.LogType.uncaughtError?{type:e.type,error:h[$.indexOf(e.error)]}:e);return{...o,type:i.FileType.POST_ANALYZE,test:{...o.test,logs:w}}})};exports.default=d;
},{"../utils/index.ts":"s2T4","../types.ts":"UL96"}],"OClX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("path")),t=require("rxjs"),r=u(require("../utils/localRequire.ts")),l=require("../utils/index.ts");function u(e){return e&&e.__esModule?e:{default:e}}let a;var o=u=>t.Observable.create(o=>{let s;a||(a=(0,r.default)("puppeteer"));const n=a.then(e=>e.launch({devtools:!0}));return n.then(r=>{s||o.next(t.Observable.create(t=>{const a=r.newPage(),o=e.default.resolve(__dirname,"..","dist","empty.html"),s=(0,l.transformPathToEpkUrl)(o,u.port);return a.then(e=>{t.next({loadFile:t=>e.goto(s).then(()=>e.addScriptTag({url:t.url})),exec:t=>e.evaluate(t)})}),()=>a.then(e=>e.close())}))}),()=>{s=!0,n.then(e=>e.close())}});exports.default=o;
},{"../utils/localRequire.ts":"5j1f","../utils/index.ts":"s2T4"}],"rfHs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("rxjs/operators"),t=o(require("../targets/chrome.ts")),r=require("../types.ts");function o(e){return e&&e.__esModule?e:{default:e}}const s=new Map([[r.TARGET.CHROME,t.default]]);var a=(t,r)=>{var o;const a=s.get(t)(r);return a.target=t,a.options=r,o=a,(0,e.map)(e=>(e.target=t,e.options=r,e))(o)};exports.default=a;
},{"../targets/chrome.ts":"OClX","../types.ts":"UL96"}],"7QpE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("rxjs"),r=require("rxjs/operators"),t=c(require("./test.ts")),a=c(require("./server.ts")),s=c(require("./analyze.ts")),u=c(require("./bundler.ts")),o=require("./utils.ts"),i=c(require("./post-analyze.ts")),l=c(require("../utils/localRequire.ts")),n=require("../utils/index.ts"),d=c(require("./target-runtime-provider.ts")),p=require("../types.ts");function c(e){return e&&e.__esModule?e:{default:e}}var R=c=>{var R,f,m;Object.keys(c).forEach(e=>void 0===c[e]&&delete c[e]);const E=c.target||p.BUNDLER_TARGET.BROWSER,h={browsers:["chrome"],target:E,outDir:`.epk/dist/${E}`,watch:!0,cache:!0,cacheDir:`.epk/cache/${E}`,port:void 0,minify:!1,scopeHoist:!1,logLevel:0,sourceMaps:!0,detailedReport:!1,throwErrors:!0,hmr:!1,...c};let g;return o.isBrowser||h.target!==p.BUNDLER_TARGET.BROWSER||(g=(0,l.default)("get-port").then(e=>e({port:10485})).then(e=>h.port=e)),m=(0,e.of)([(0,u.default)(h),(o.isBrowser||h.target!==p.BUNDLER_TARGET.BROWSER?[h.target]:h.browsers).map(e=>(0,d.default)(e,h))]),f=(o.isBrowser||h.target!==p.BUNDLER_TARGET.BROWSER?(0,r.tap)():(0,r.delayWhen)(()=>(0,e.from)(g)))(m),R=(o.isBrowser||h.target!==p.BUNDLER_TARGET.BROWSER?(0,r.tap)():(0,a.default)(h))(f),(0,r.mergeMap)(([a,u])=>{var o,l,d;return(0,e.merge)((o=a,(0,r.filter)(({name:e})=>"buildStart"===e)(o)),(l=a,(0,r.filter)(({name:e})=>"bundled"===e)(l)),(d=(0,e.merge)(...u),(0,r.mergeMap)(u=>{var o,l;return l=a,o=(0,r.filter)(({name:e})=>"bundled"===e)(l),(0,r.switchMap)(({bundle:a})=>{var o;return o=(0,e.from)(a.isEmpty?Array.from(a.childBundles):[a]),(0,r.mergeMap)(a=>{var o,l,d,c,R,f,m;const{name:E}=a,g=(o=(0,e.of)({target:u.target,name:a.entryAsset.name,path:E,url:h.target===p.BUNDLER_TARGET.BROWSER&&(0,n.transformPathToTestUrl)(E,h.port)}),(0,r.publish)()(o)),B=(d=g,l=(0,s.default)(u,h)(d),(0,r.publish)()(l)),v=(R=B,c=(0,r.switchMap)(r=>{var a;return a=(0,e.from)(r.tests),(0,t.default)(r,u,h)(a)})(R),(0,r.publish)()(c)),T=(m=v,f=(0,i.default)(h,a)(m),(0,r.publish)()(f)),b=(0,e.merge)(g,B,v,T);return T.connect(),v.connect(),B.connect(),g.connect(),b})(o)})(o)})(d)))})(R)};exports.default=R;
},{"./test.ts":"kg0f","./server.ts":"ZgGC","./analyze.ts":"x4LZ","./bundler.ts":"Wis+","./utils.ts":"hIne","./post-analyze.ts":"hsK/","../utils/localRequire.ts":"5j1f","../utils/index.ts":"s2T4","./target-runtime-provider.ts":"rfHs","../types.ts":"UL96"}],"PU1U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.logs=void 0;var e=require("../types.ts"),r=require("../core/utils.ts");const o=[];exports.logs=o;const s=s=>{const t=r.isBrowser?s instanceof ErrorEvent?s.error:s instanceof PromiseRejectionEvent&&s.reason:s;o.push({type:e.LogType.uncaughtError,error:{name:t.name,message:t.message,string:t.toString(),stack:t.stack}})};r.isBrowser?(window.addEventListener("error",s),window.addEventListener("unhandledrejection",s)):(process.on("uncaughtException",s),process.on("unhandledRejection",s)),r.globalVariable.console=new Proxy(r.globalVariable.console,{get:(r,s,t)=>Object.keys(e.LogType).includes(s)?(...e)=>(o.push({type:s,arguments:e}),Reflect.get(r,s,t)(...e)):Reflect.get(r,s,t)});
},{"../types.ts":"UL96","../core/utils.ts":"hIne"}],"YymI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.test=exports.fail=exports.pass=exports.todo=exports.tests=void 0;var e=require("events"),t=require("flatted"),s=require("rxjs"),r=require("rxjs/operators"),o=require("../core/utils.ts"),i=require("../types.ts"),n=require("./logging.ts");const a=new Map;exports.tests=a;const p=e=>{};exports.todo=p;const E=e=>{};exports.pass=E;const d=e=>{};exports.fail=d;const c=(e,t)=>{if("string"!=typeof e)throw new Error("desc has to be a string");if("function"!=typeof t)throw new Error("func has to be a function");if(a.has(e))throw new Error(`Found duplicate test description: ${e}`);a.set(e,t)};exports.test=c;const f=(e,t)=>o.isBrowser?window.parent.postMessage({type:e,data:t},"*"):global[i.NODE_GLOBAL].emit("message",{type:e,data:t}),l=()=>f(i.MESSAGE_TYPE.GET_TESTS_RESPONSE,Array.from(a).map(([e,t])=>({description:e,body:t.toString()}))),u=e=>(0,t.stringify)(e,(e,t)=>"function"==typeof t?{[i.FUNCTION_PROPERTY]:t.name}:t),w=async e=>{const{performance:t}=window;let o,p,E;try{var d;if(o=t.now(),E=await a.get(e)(),(0,s.isObservable)(E))E=await(d=E,(0,r.toArray)()(d)).toPromise()}finally{p=t.now(),setTimeout(()=>f(i.MESSAGE_TYPE.RUN_TEST_RESPONSE,{timeStart:o,timeEnd:p,type:(0,s.isObservable)(E)?"observable":E instanceof Promise?"promise":"function",value:u(E),logs:u(n.logs)}))}},S=({data:{type:e,description:t}})=>{e===i.MESSAGE_TYPE.GET_TESTS&&l(),e===i.MESSAGE_TYPE.RUN_TEST&&w(t)};if(o.isBrowser)window.addEventListener("message",S);else{(global[i.NODE_GLOBAL]=new e.EventEmitter).addListener("message",S)}
},{"../core/utils.ts":"hIne","../types.ts":"UL96","./logging.ts":"PU1U"}],"kBKS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=void 0;var e=t(require("power-assert"));function t(e){return e&&e.__esModule?e:{default:e}}const r=e.default.customize({});exports.assert=r;
},{}],"Gd7L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"test",{enumerable:!0,get:function(){return e.test}}),Object.defineProperty(exports,"assert",{enumerable:!0,get:function(){return t.assert}});var e=require("./test.ts"),t=require("./assert.ts");
},{"./test.ts":"YymI","./assert.ts":"kBKS"}],"3Fhe":[function(require,module,exports) {
var t=null;function e(){return t||(t=n()),t}function n(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return r(t[0])}return"/"}function r(t){return(""+t).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)\/[^\/]+$/,"$1")+"/"}exports.getBundleURL=e,exports.getBaseURL=r;
},{}],"21/1":[function(require,module,exports) {
var r=require("./bundle-url").getBundleURL;function e(r){Array.isArray(r)||(r=[r]);var e=r[r.length-1];try{return Promise.resolve(require(e))}catch(n){if("MODULE_NOT_FOUND"===n.code)return new s(function(n,i){t(r.slice(0,-1)).then(function(){return require(e)}).then(n,i)});throw n}}function t(r){return Promise.all(r.map(u))}var n={};function i(r,e){n[r]=e}module.exports=exports=e,exports.load=t,exports.register=i;var o={};function u(e){var t;if(Array.isArray(e)&&(t=e[1],e=e[0]),o[e])return o[e];var i=(e.substring(e.lastIndexOf(".")+1,e.length)||e).toLowerCase(),u=n[i];return u?o[e]=u(r()+e).then(function(r){return r&&module.bundle.register(t,r),r}).catch(function(r){throw delete o[e],r}):void 0}function s(r){this.executor=r,this.promise=null}s.prototype.then=function(r,e){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.then(r,e)},s.prototype.catch=function(r){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.catch(r)};
},{"./bundle-url":"3Fhe"}],"7QCb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./core/index.ts");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./test/index.ts");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})}),module.parent||require("_bundle_loader")(require.resolve("./cli/index.ts")).then(()=>{});
},{"./core/index.ts":"7QpE","./test/index.ts":"Gd7L","_bundle_loader":"21/1","./cli/index.ts":[["cli.ca6e964b.js","Q0HP"],"Q0HP"]}],"gIV6":[function(require,module,exports) {
var n=require("fs");module.exports=function(e){return new Promise(function(t,i){n.readFile(__dirname+e,"utf8",function(n,e){n?i(n):setImmediate(function(){t(e)})})}).then(function(n){new Function("",n)()})};
},{}],0:[function(require,module,exports) {
var b=require("21/1");b.register("js",require("gIV6"));
},{}]},{},[0,"7QCb"], null)