{"version":3,"file":"worker.js","sources":["../src/core/task.ts","../src/worker/index.ts"],"sourcesContent":["import { Observable } from 'rxjs'\r\n\r\nexport enum TASK_TYPE {\r\n  PRE_ANALYZE = 'preAnalyze',\r\n  RUN = 'run',\r\n  ANALYZE = 'analyze'\r\n}\r\n\r\nexport enum TASK_STATUS {\r\n  START = 'start',\r\n  READY = 'ready',\r\n  END = 'end',\r\n  CANCEL = 'cancel'\r\n}\r\n\r\nexport interface Task {\r\n  type: TASK_TYPE\r\n  data: any\r\n}\r\n\r\nexport interface TaskMessage {\r\n  type: TASK_TYPE\r\n  status: TASK_STATUS\r\n  data?: any\r\n}\r\n\r\n// export default\r\n//   (task: Task) =>\r\n//     messages =>\r\n//       messages\r\n//       |> \r\n\r\n\r\n// export default (task: Task) =>\r\n//   Observable.create(observer => {\r\n//     let _observer\r\n//     const task = Observable.create<TaskMessage>(observer => {\r\n//       _observer = observer\r\n//       observer.next({ type: TASK_STATUS.START })\r\n//       return () => observer.next({ type: TASK_STATUS.CANCEL })\r\n//     })\r\n//     workerFarm.next(task)\r\n//     return () => _observer.complete()\r\n//   })\r\n","import { Worker, isMainThread, parentPort, workerData } from 'worker_threads'\r\nimport { TASK_STATUS } from '../core/task.ts'\r\n\r\nparentPort.on('message', (message) => {\r\n  console.log('received', message)\r\n  if (message.status === TASK_STATUS.START) parentPort.postMessage({ status: TASK_STATUS.READY })\r\n  setTimeout(() => parentPort.postMessage({ status: TASK_STATUS.END }), 1000)\r\n})\r\n// setTimeout(() => parentPort.postMessage({ status: TASK_STATUS.END }), 1000)\r\n"],"names":["TASK_TYPE","TASK_STATUS","parentPort","on","message","console","log","status","START","postMessage","READY","setTimeout","END"],"mappings":";;;;IAEYA,SAAZ;;WAAYA;EAAAA;EAAAA;EAAAA;GAAAA,cAAAA;;AAMZ,IAAYC,WAAZ;;WAAYA;EAAAA;EAAAA;EAAAA;EAAAA;GAAAA,gBAAAA;;;;;;;;;;;;;;;;;ACLZC,yBAAU,CAACC,EAAX,CAAc,SAAd,EAA0BC,OAAD,IAAa;EACpCC,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,OAAxB;MACIA,OAAO,CAACG,MAAR,KAAmBN,WAAW,CAACO,KAAnC,EAA0CN,yBAAU,CAACO,WAAX,CAAuB;IAAEF,MAAM,EAAEN,WAAW,CAACS;GAA7C;EAC1CC,UAAU,CAAC,MAAMT,yBAAU,CAACO,WAAX,CAAuB;IAAEF,MAAM,EAAEN,WAAW,CAACW;GAA7C,CAAP,EAA4D,IAA5D,CAAV;CAHF"}